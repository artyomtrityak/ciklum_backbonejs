define(["./models_mocks"],function(e){var t={create:"POST",update:"PUT","delete":"DELETE",read:"GET"},n=Backbone.Collection.extend({sync:function(e,n,r){var i=this,s=t[e];r||(r={});var o={type:s,dataType:"xml"};r.url||(o.url=_.result(n,"url")),o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{};var u=r.success;r.success=function(e,t,s){e=i.parse_xml(e),u&&u(e,t,s),n.trigger("sync",n,e,r)};var a=r.error;return r.error=function(e,t,i){a&&a(n,e,r),n.trigger("error",n,e,r)},$.ajax(_.extend(o,r))},parse_xml:function(e){var t=[];return $(e).find("root > users > user").each(function(e,n){t.push({id:$(n).find("id").text(),username:$(n).find("username").text(),type:$(n).find("type").text()})}),$(e).find("root > articles > article").each(function(e,n){t.push({id:$(n).find("id").text(),topic:$(n).find("topic").text(),type:$(n).find("type").text()})}),t}}),r=n.extend({url:"/static/test.xml",model:function(t,n){switch(t.type){case"user":return new e.UserModel(t,n);case"article":return new e.ArticleModel(t,n);default:throw"Unknown model"}}}),i=new r;i.fetch(),console.log("XML collection"),console.log(i)})